---
title: "CAMS: CAMS_GEARCODE_STRATA"
#author: "Ben Galuardi"
output:
  html_document: default
  github_document:
  pdf_document: default
always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(odbc)
library(ROracle)
library(dplyr, warn.conflicts = FALSE)


 dw_maps <- config::get(config = "maps", file = "~/config_group.yml")
# 
 # bcon <- dbConnect(odbc::odbc(), 
 # 									DSN = dw_maps$dsn, 
 # 									UID = dw_maps$uid, 
 # 									PWD = dw_maps$pwd)

# Connect to database - move this to config file in the future - quick addition for server
  connectString <- paste(
    "(DESCRIPTION=",
    "(ADDRESS=(PROTOCOL=tcp)(HOST=", dw_maps$host, ")(PORT=", dw_maps$port, "))",
    "(CONNECT_DATA=(SERVICE_NAME=",dw_maps$svc, ")))",
    sep = ""
  )

# Connect to oracle each loop in case of timeouts
    bcon <- ROracle::dbConnect(
      drv = ROracle::Oracle(),
      username = dw_maps$uid,
      password = dw_maps$pwd,
      dbname = connectString
    )

```


## Summary
This discard support table translates species VTR gear code to the CAMS gear code used for discard stratification based on gear stratification used in current stock assessments and quota monitoring.  Species specific gear stratifications have been agreed upon by a discards working group.

## Description

- **OUTPUT TABLE:** CAMS_GARFO.CAMS_GEARCODE_STRATA
- **YEARS:** N/A
- **RESOLUTION:** Gearcode translation from VTR gear code to cams_gear_group by species
- **DEVELOPMENT LANGUAGE:** N/A
- **CODE:** N/A


```{r table_flow0, echo=F,fig.height=3,fig.width=8, fig.cap="Figure 1.   MAPS.CAMS_GEARCODE_STRATA table lineage"}
DiagrammeR::mermaid("
  graph LR
  MAPS.CAMS_GEARCODE_STRATA --> GF_and_Non_GF_Discard_Modules
        ")
```

## Data Dictionary

```{r echo = F}
comments <- ROracle::dbGetQuery(bcon, "SELECT * FROM all_col_comments WHERE owner = 'MAPS' AND table_name = 'CAMS_GEARCODE_STRATA'")

comments %>%
dplyr::select(
COLUMN = COLUMN_NAME,
DESCRIPTION = COMMENTS) %>%
knitr::kable(booktabs = TRUE) %>%
kableExtra::kable_styling(bootstrap_options = c("striped", 
"hover", "condensed", "responsive"),full_width = FALSE,position = "left", fixed_thead = TRUE,
font_size = 10)
```

